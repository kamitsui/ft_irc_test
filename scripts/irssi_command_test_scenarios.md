# IRC Server Commands Usage and Test Cases (irssi client)

以下に、IRCサーバーコマンドのirssiクライアントでの使い方と、それぞれの動作確認のシナリオをまとめます。

## PASS

- **irssiでの使い方**: `irssi`は通常、`PASS`コマンドを直接ユーザーが入力することはありません。ネットワーク接続時にサーバーへ自動的に送信されます。`irssi`のネットワーク設定でパスワードを設定します。
  - `/network add -sasl_username <username> -sasl_password <password> <network_name>`
  - `/server add -network <network_name> <server_address> <port>`
- **動作確認**:
  - パスワードが正しく設定された状態でサーバーに接続を試みる。
  - サーバーログで`PASS`コマンドが正しく送信されていることを確認する。
  - 誤ったパスワードで接続を試み、拒否されることを確認する。

## NICK

- **irssiでの使い方**: ニックネームを変更します。
  - `/nick <new_nickname>`
- **動作確認**:
  - 正常なニックネーム変更: `/nick new_nick` を実行後、他のクライアントから`new_nick`として表示されることを確認。
  - 無効なニックネーム: 不正な文字や長すぎるニックネームで変更を試み、サーバーからエラーが返されることを確認。
  - 既に存在するニックネーム: 既に使われているニックネームに変更を試み、サーバーからエラーが返されることを確認。

## USER

- **irssiでの使い方**: `irssi`は接続時に自動的に`USER`コマンドを送信します。ユーザーは通常直接入力しませんが、設定で変更できます。
  - `/set username <username>`
  - `/set real_name <realname>`
- **動作確認**:
  - 接続後、`/whois <your_nickname>` を実行し、ユーザー名とリアルネームが正しく表示されることを確認。
  - サーバーログで`USER`コマンドが正しく送信されていることを確認する。

## JOIN

- **irssiでの使い方**: チャンネルに参加します。
  - `/join #<channel_name>`
  - ~~パスワード付きチャンネル: `/join #<channel_name> <password>`~~
- **動作確認**:
  - 正常なチャンネル参加: `/join #test` を実行後、チャンネルに参加し、他のユーザーに通知され、自分自身もチャンネルリストに表示されることを確認。
  - 存在しないチャンネル: `/join #non_existent_channel` を実行後、新規チャンネルとして作成されるか、サーバーの設定によってはエラーになることを確認（通常は新規作成）。
  - パスワード付きチャンネルへの参加と拒否。

## PRIVMSG

- **irssiでの使い方**: メッセージをユーザーまたはチャンネルに送信します。
  - チャンネルへ: `/msg #<channel_name> <message>` またはチャンネルウィンドウでメッセージを入力。
  - ユーザーへ: `/msg <nickname> <message>` またはクエリウィンドウでメッセージを入力。
- **動作確認**:
  - チャンネルメッセージ: チャンネルでメッセージを送信し、他のクライアントで受信されることを確認。
  - プライベートメッセージ: 特定のユーザーにメッセージを送信し、そのユーザーが受信することを確認。
  - 存在しないチャンネル/ユーザーへのメッセージ: サーバーからエラーが返されることを確認。

## PART

- **irssiでの使い方**: チャンネルから退出します。
  - `/part #<channel_name>`
  - 退出メッセージ付き: `/part #<channel_name> <message>`
- **動作確認**:
  - 正常なチャンネル退出: `/part #test` を実行後、チャンネルから退出され、他のユーザーに通知され、自分自身のチャンネルリストから消えることを確認。
  - 存在しないチャンネルからの退出: サーバーからエラーが返されることを確認。

## QUIT

- **irssiでの使い方**: IRCサーバーから切断します。
  - `/quit`
  - 終了メッセージ付き: `/quit <message>`
- **動作確認**:
  - 正常な切断: `/quit` を実行後、サーバーから切断され、他のユーザーに`QUIT`メッセージが通知されることを確認。
  - 終了メッセージが正しく送信されることを確認。

## PING

- **irssiでの使い方**: サーバーへ`PING`を送信し、応答時間を確認します。`irssi`はアイドル時に自動で`PING`を送信しますが、手動でサーバーの応答を確認することもできます。
  - `/server raw PING :<token>` (通常はクライアントが自動で行う)
- **動作確認**:
  - クライアントがサーバーから`PING`を受け取った際に、`PONG`を正しく返しているかサーバーログで確認。
  - `/server raw PING :<some_id>` を送信し、サーバーが`PONG :<some_id>` を返すことを確認。

## PONG

- **irssiでの使い方**: `irssi`はサーバーからの`PING`に対して自動的に`PONG`を返します。ユーザーが直接入力することはありません。
- **動作確認**:
  - `PING`の動作確認と同様。サーバーが`PING`を送信し、クライアントが`PONG`を返すことをサーバーログで確認。

## NOTICE

- **irssiでの使い方**: `PRIVMSG`と同様ですが、クライアントは通常`NOTICE`メッセージに対する自動応答はしません。主にサーバーからの情報通知やBotからの応答に使用されます。
  - `/notice #<channel_name> <message>`
  - `/notice <nickname> <message>`
- **動作確認**:
  - チャンネルへの`NOTICE`: `/notice #test hello` を送信し、他のクライアントで受信されることを確認。
  - ユーザーへの`NOTICE`: `/notice <nickname> hello` を送信し、そのユーザーが受信することを確認。
  - クライアントが`NOTICE`に対して自動応答しないことを確認。

## NAMES

- **irssiでの使い方**: チャンネルのユーザーリストを表示します。
  - `/names #<channel_name>`
- **動作確認**:
  - チャンネルに参加後、`/names #test` を実行し、そのチャンネルにいる全ユーザー（オペレーター、ボイスなども含む）が正しくリストアップされることを確認。
  - 存在しないチャンネル: エラーが返されることを確認。

## TOPIC

- **irssiでの使い方**: チャンネルのトピックを表示または変更します。
  - 表示: `/topic #<channel_name>`
  - 変更: `/topic #<channel_name> <new_topic>`
- **動作確認**:
  - トピックの表示: `/topic #test` を実行後、現在のトピックが表示されることを確認。
  - トピックの変更: `/topic #test :新しいトピック` を実行後、トピックが変更され、他のクライアントにも通知されることを確認。
  - 権限がないユーザーがトピック変更を試み、拒否されることを確認（チャンネルモードによる）。

## MODE

- **irssiでの使い方**: ユーザーまたはチャンネルのモードを設定/解除します。
  - チャンネルモード: `/mode #<channel_name> +o <nickname>` (オペレーター権限付与)
  - ユーザーモード: `/mode <your_nickname> +i` (インビジブルモード)
- **動作確認**:
  - チャンネルモードの変更: `/mode #test +i` (招待制) や `/mode #test +k <key>` (キー付き) などを設定し、その効果が適用されることを確認。
  - ユーザーモードの変更: `/mode <nickname> +i` を設定後、`/who <nickname>` で`i`フラグが立つことを確認。
  - 権限がないユーザーがチャンネルモード変更を試み、拒否されることを確認。

## KICK

- **irssiでの使い方**: チャンネルからユーザーを強制的に退出させます。
  - `/kick #<channel_name> <nickname>`
  - 理由付き: `/kick #<channel_name> <nickname> :<reason>`
- **動作確認**:
  - 正常なキック: オペレーター権限を持つユーザーで `/kick #test user1` を実行後、`user1`がチャンネルから退出され、他のユーザーに通知されることを確認。
  - 権限がないユーザーがキックを試み、拒否されることを確認。
  - 存在しないユーザーをキックしようと試み、エラーが返されることを確認。

## LIST

- **irssiでの使い方**: 利用可能なチャンネルのリストを表示します。
  - `/LIST -YES`
  - フィルタリング: `/list -min 5` (最低5人いるチャンネル)
- **動作確認**:
  - `/list` を実行後、サーバー上の全チャンネルとそのトピック、参加人数が正しく表示されることを確認。
  - フィルタリングオプション (`-min`, `-max`, `-topic`) が正しく機能することを確認。

## WHO

- **irssiでの使い方**: ユーザーの情報を表示します。
  - `/who #<channel_name>` (チャンネルの全ユーザー)
  - `/who <nickname>` (特定のユーザー)
- **動作確認**:
  - チャンネル内のユーザー情報: `/who #test` を実行後、`#test`チャンネル内の各ユーザーのニックネーム、ユーザー名、ホスト、リアルネーム、アイドル時間などが正しく表示されることを確認。
  - 特定のユーザー情報: `/who <nickname>` で指定ユーザーの情報が取得されることを確認。

## WHOIS

- **irssiでの使い方**: 特定のユーザーの詳細情報を表示します。
  - `/whois <nickname>`
- **動作確認**:
  - `/whois <nickname>` を実行後、そのユーザーのニックネーム、ユーザー名、ホスト、リアルネーム、接続サーバー、アイドル時間、参加チャンネルなどが詳細に表示されることを確認。
  - 存在しないユーザー: エラーが返されることを確認。

## INVITE

- **irssiでの使い方**: ユーザーをチャンネルに招待します。
  - `/invite <nickname> #<channel_name>`
- **動作確認**:
  - 正常な招待: `/invite user2 #test` を実行後、`user2`に招待メッセージが送信され、`user2`が招待されたチャンネルに参加できることを確認。
  - 招待制チャンネル (`+i`モード) での招待が機能することを確認。
  - 権限がないユーザーが招待を試み、拒否されることを確認。
